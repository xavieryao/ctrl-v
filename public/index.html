<!DOCTYPE html>
<html>
<head>
	<title>Gists</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<!-- 新 Bootstrap 核心 CSS 文件 -->
	<link rel="stylesheet" href="./stylesheets/bootstrap.css">
	<link rel="stylesheet" href="./stylesheets/my_style.css">
	<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
	<script src="./javascripts/jquery.js"></script>
	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script src="./javascripts/bootstrap.js"></script>
</head>
<body>
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand" href="#">Gists</a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active">
						<a href="#">Create</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="container">
		<div class="starter-template">
			<div class="row">  <div id = "alert_placeholder"></div></div>
			<h2>Put your code here!<br /><small>From PaperAirplane Dev</small></h2>
			<div class="row">
				<div class="col-xs-8"> <!-- Editor -->
					<div class="row" id="control"><!-- control -->
						<div class="dropdown">
						  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
						    <b>Language</b>
						    <span class="caret"></span>
						  </button>
						  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
						    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">JavaScript</a></li>
						    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">CoffeeScript</a></li>
						    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Markdown</a></li>
						    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">HTML</a></li>
						  </ul>
						</div>
					</div> 
					<div id="editor">function foo(items) {
    				var x = "All this is syntax highlighted";
    				return x;
					}</div>
				</div>
				<div class="col-xs-4"><button class="btn btn-default" id="save">Save</button></div>
			</div>
		</div>

	</div>
	<script src="./javascripts/ace/ace.js" type="text/javascript" charset="utf-8"></script>
	<script>
	    var editor = ace.edit("editor");
    	editor.setTheme("ace/theme/monokai");
    	editor.getSession().setMode("ace/mode/javascript");
    	var alert = function(message) {
    		$('#alert_placeholder').html('<div class="alert alert-success" role="alert"><a class="close" data-dismiss="alert">×</a><span>'+message+'</span></div>')
  		}
  		$('#save').click(function(){
  			console.log('save');
  			var file = editor.getValue(); 
  			$.ajax({
  				type:'POST',
  				url:'/gists/create',
  				data:{code:file,lang:'js'},
  				success:function(r){
  					alert(r);
  				},
  				error:function(xhr,err){
  					alert(err);
  				}
  			});
  		});
	</script>
</body>
